!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=0)}({0:function(e,t,n){e.exports=n("ERIh")},"4lKV":function(e){e.exports=JSON.parse('{"stage_0":{"message":"Don’t let a scammer steal your pension pot! ","instruction":"Swipe left and right to move Scam Man, and swipe upwards to activate his torch and shine a light on an incoming scam! Collect as many coins and bonuses as you can, so you can retire happily at the age of 65! ","scams":["generic_scam"],"boons":["generic_boon"]},"stage_1":{"path":"assets/scenes/Level_1_v3.png","scams":["normal_scam","accelerator"],"boons":["refuse","pension_wise"]},"stage_2":{"path":"assets/scenes/Level_2_v3.png","scams":["speedy","zig_zag"],"boons":["thinking_about","invisiblity_boon"]},"stage_3":{"path":"assets/scenes/Level_3_v3.png","scams":["diagonal","splitter"],"boons":["no_rash_decision","dont_transfer"]}}')},Ccqu:function(e){e.exports=JSON.parse('{"message":{"generic_scam":{"name":"tutorial_scam","info":"Generic Scam","icon":"Red Border logo","path":"assets/scenes/Generic_scam.png"},"normal_scam":{"name":"Cold call:","info":"You receive a cold call about your pension","icon":"FCA logo","reduction":400,"path":"assets/scenes/Cold_call_v2.png"},"accelerator":{"name":"Free advice:","info":"You accept ‘free’ financial advice","icon":"pound signs with a cross through it","reduction":300,"path":"assets/scenes/Free_advice_v2.png"},"speedy":{"name":"Time pressure:","info":"You feel pressured to make an immediate decision","icon":" clock","reduction":600,"path":"assets/scenes/Time_pressure_v2.png"},"zig_zag":{"name":"False claims:","info":"You let an unknown provider convince you to make changes","icon":"a phone","reduction":500,"path":"assets/scenes/Fake_vigilante_v2.png"},"splitter":{"name":"Early access:","info":" You’re promised access to your pension before you turn 55","icon":"a non-standard coloured coin","reduction":800,"path":"assets/scenes/Early_withdrawl_v2.png"},"black_out":{"name":"Black out:","info":"You engaged with a company because they offered a unique or limited investment opportunity","icon":"something unusual","reduction":500,"path":"assets/scenes/scam.png"},"diagonal":{"name":"Safe Haven:","info":"You move your pension to a fund that guarantees coronavirus protection and high returns","icon":"mini scam man","reduction":400,"path":"assets/scenes/virus.png"},"generic_boon":{"name":"Tutorial boon","info":"Generic Boon","icon":"Green Border logo","path":"assets/scenes/Bonus.png"},"normal_boon":{"name":"Boon:","info":"Check FCA registered - get FCA number","icon":"FCA logo","reduction":100,"path":"assets/scenes/Refuse_v2.png"},"refuse":{"name":"Hang up:","info":"You refuse to discuss your pension with strangers","icon":"FCA logo","path":"assets/scenes/Refuse_v2.png","addition":100},"pension_wise":{"name":"Reject unsolicited advice:","info":"You get impartial information from Pension Wise","icon":"FCA logo","path":"assets/scenes/Pensionwise_v2.png","addition":200},"thinking_about":{"name":"Ask for more time:","info":"You take your time and won’t be rushed","icon":"FCA logo","path":"assets/scenes/Thinking_about_v2.png","addition":300},"invisiblity_boon":{"name":"Do your homework:","info":"You check the FCA’s Financial Services Register*","icon":"FCA logo","path":"assets/scenes/FCA_v2.png","addition":400},"dont_transfer":{"name":"You wait until you turn 55:","info":"You refuse to transfer your pension for early withdrawal","icon":"FCA logo","path":"assets/scenes/Don\'t_transfer_v3.png","addition":500},"no_rash_decision":{"name":"You question guarantees:","info":"You refuse to move your pension based on false claims and guarantees","icon":"FCA logo","path":"assets/scenes/no_rash_decisions.png","addition":500}}}')},ERIh:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t);var s=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];i(this,e),this.currentID=0,this.logs=[],this.enabled=t}var t,n,s;return t=e,(n=[{key:"push",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.enabled&&(e.ID=++this.currentID,this.logs.push(e))}},{key:"doing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.push({doing:e})}},{key:"getLast",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.logs.slice(-e)}},{key:"logLast",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;console.log(this.getLast(e))}},{key:"get",value:function(){return this.logs}},{key:"log",value:function(){console.log(this.logs)}},{key:"debug",value:function(e){GAME.options.debugMode&&console.log("DEBUG LOG: "+e)}},{key:"debugWarning",value:function(e){GAME.options.debugMode&&console.warn("DEBUG LOG: "+e)}},{key:"debugError",value:function(e){GAME.options.debugMode&&console.error("DEBUG LOG: "+e)}}])&&o(t.prototype,n),s&&o(t,s),e}(),a=n("Ccqu");function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentControlID=0,this.controls=[],this.menuTexture=BABYLON.GUI.AdvancedDynamicTexture.CreateFullscreenUI(t,!n)}var t,n,i;return t=e,(n=[{key:"addButton",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=new BABYLON.GUI.Button.CreateSimpleButton(e,t);return i.width=n.width||.5,i.height=n.height||"60px",i.color=n.color||"black",i.outlineWidth=n.outlineWidth||0,i.fontSize=n.fontSize||"20em",i.outlineColor=n.outlineColor||i.color,i.background=n.background||"white",i.horizontalAlignment=void 0!==n.horizontalAlignment?n.horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,i.verticalAlignment=void 0!==n.verticalAlignment?n.verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER,i.left=n.left||"0px",i.right=n.right||"0px",i.top=n.top||"0px",i.textHorizontalAlignment=void 0!==n.horizontalAlignment?n.horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,i.textVerticalAlignment=void 0!==n.verticalAlignment?n.verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER,n.onclick&&i.onPointerUpObservable.add(n.onclick),this.menuTexture.addControl(i),this.add(i),i}},{key:"addImgButton",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new BABYLON.GUI.Button.CreateImageOnlyButton(e,t.imgpath);return n.thickness=t.thickness||0,n.width=t.width||.5,n.height=t.height||"60px",n.color=t.color||"black",n.outlineWidth=t.outlineWidth||0,n.outlineColor=t.outlineColor||n.color,n.background=t.background||"transparent",n.horizontalAlignment=void 0!==t.horizontalAlignment?t.horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,n.verticalAlignment=void 0!==t.verticalAlignment?t.verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER,n.left=t.left||"0px",n.isVisible=t.isVisible||!0,n.right=t.right||"0px",n.top=t.top||"20px",n.textHorizontalAlignment=void 0!==t.horizontalAlignment?t.horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,n.textVerticalAlignment=void 0!==t.verticalAlignment?t.verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER,t.onclick&&n.onPointerUpObservable.add(t.onclick),this.menuTexture.addControl(n),this.add(n),n}},{key:"pauseScreen",value:function(e,t,n,i){GAME.pause();var o=new BABYLON.GUI.Rectangle;o.width=1,o.height=1,o.thickness=0,o.background="#0EAFDE",o.alpha=1,this.menuTexture.addControl(o);var s=new BABYLON.GUI.Rectangle;s.width=.9,s.height=1,s.thickness=0,s.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,o.addControl(s);var r=new BABYLON.GUI.TextBlock("Pension Pot","Pension pot £:"+e);r.top="7em",r.color=GAME.options.pointsTextColor,r.outlineColor=GAME.options.pointsOutlineTextColor,r.outlineWidth=0,r.fontSize="15px",r.textHorizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,r.textVerticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,s.addControl(r);var l=new BABYLON.GUI.TextBlock("Scam Count","Scam Count :"+t);l.top="7em",l.color=GAME.options.pointsTextColor,l.outlineColor=GAME.options.pointsOutlineTextColor,l.outlineWidth=0,l.fontSize="12px",l.textHorizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_RIGHT,l.textVerticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,s.addControl(l);var c=new BABYLON.GUI.TextBlock("Boon Count","Boon Count :"+n);if(c.top="21em",c.color=GAME.options.pointsTextColor,c.outlineColor=GAME.options.pointsOutlineTextColor,c.outlineWidth=0,c.fontSize="12px",c.textHorizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_RIGHT,c.textVerticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,s.addControl(c),i&&i.size)for(var h=Array.from(i),u=0,d=0;d<i.size;d++){var p=h[d],g=a.message,m=new BABYLON.GUI.Image("icon",g[p].path);m.width=.15,m.height=.08,m.top=36+u,m.left=.1,m.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,m.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,s.addControl(m);var A=new BABYLON.GUI.Rectangle;A.width=.75,A.height=.075,A.thickness=0,A.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_RIGHT,A.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,A.top=42+u,s.addControl(A);var v=new BABYLON.GUI.TextBlock("Scam Description",g[p].info);v.color=GAME.options.pointsTextColor,v.outlineColor=GAME.options.pointsOutlineTextColor,v.outlineWidth=0,v.top="1px",v.textVerticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER,v.fontSize="12px",v.textHorizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,v.textWrapping=!0,v.lineSpacing="0px",A.addControl(v),GAME.isMobile()?u+=55:u+=100}else{var f=new BABYLON.GUI.TextBlock("CASUAL","You haven't hit any scams");f.color="red",f.fontSize="28em",s.addControl(f)}var y=new BABYLON.GUI.Button.CreateSimpleButton("RESUME","RESUME");y.width=.2,y.height=.05,y.color="black",y.fontSize="10em",y.background="white",y.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,y.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM,y.top="-5em",y.onPointerUpObservable.add((function(){GAME.resume(),o.dispose(),s.dispose()})),s.addControl(y)}},{key:"addText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new BABYLON.GUI.TextBlock;return n.width=t.width||1,n.text=e,n.color=t.color||"black",n.fontSize=t.fontSize||20,n.fontStyle=t.fontStyle||"",n.outlineWidth=t.outlineWidth||0,n.outlineColor=t.outlineColor||"black",n.lineSpacing=t.lineSpacing||"0px",n.left=t.left||"0px",n.paddingRight=t.paddingRight||"0px",n.top=t.top||"0px",n.textHorizontalAlignment=void 0!==t.horizontalAlignment?t.horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,n.textVerticalAlignment=void 0!==t.verticalAlignment?t.verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,n.textWrapping=t.wrapping||!0,n.fontFamily="'Tomorrow', sans-serif",this.menuTexture.addControl(n),this.add(n),n}},{key:"addImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new BABYLON.GUI.Image(e,t.imgpath);return n.thickness=0,n.strech=t.strech||BABYLON.GUI.Image.stretch_uniform,n.width=t.width||.5,n.height=t.height||"60px",n.color=t.color||"black",n.outlineWidth=t.outlineWidth||0,n.outlineColor=t.outlineColor||n.color,n.background=t.background||"transparent",n.horizontalAlignment=void 0!==t.horizontalAlignment?t.horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,n.verticalAlignment=void 0!==t.verticalAlignment?t.verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER,n.left=t.left||"0px",n.right=t.right||"0px",n.top=t.top||"0px",this.menuTexture.addControl(n),this.add(n),n}},{key:"displayMessage",value:function(e,t){GAME.pause();var n=new BABYLON.GUI.Rectangle,i=new BABYLON.GUI.TextBlock("Educational Message",e),o=new BABYLON.GUI.TextBlock("Signal",t);o.color="HIT IT"==t?"red":"green",GAME.isMobile()?(n.width=1,n.height="55px",i.fontSize="14em",i.lineSpacing="1px",o.fontSize="30em",o.paddingBottom="150px",i.top="1px"):(o.fontSize="45em",o.paddingBottom="250px",n.width=1,n.height="130px",i.fontSize="35em",i.lineSpacing="2px",i.top="18px"),n.cornerRadius=0,n.thickness=0,n.background="grey",n.alpha=.7,this.menuTexture.addControl(n),this.menuTexture.addControl(o),i.fontFamily="monospace",i.color="white",i.textVerticalAlignment=0,i.textWrapping=!0,n.addControl(i),setTimeout((function(){o.dispose(),n.dispose(),GAME.resume()}),GAME.options.messageReadTime)}},{key:"add",value:function(e){e.uiControlID=this.currentControlID++,this.controls.push(e)}},{key:"remove",value:function(e){e.isVisible=!1,this.controls.splice(e.uiControlID,1)}},{key:"show",value:function(){this.controls.forEach((function(e){return e.isVisible=!0}))}},{key:"hide",value:function(){this.controls.forEach((function(e){return e.isVisible=!1}))}},{key:"clear",value:function(){this.controls.forEach((function(e){return e.dispose()})),this.menuTexture.dispose()}}])&&r(t.prototype,n),i&&r(t,i),e}();function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.message=new l("pauseScreen"),this.level=t,this.scene=t.scene,this.changePosition=!1,this.nextBullet=!0,this.bullerCounter=1,this.coins=0,this.maxCoins=0,this.scamCount=0,this.boonCount=0,this.lives=GAME.options.player.lives,this.godMode=GAME.options.player.godMode,this.allowCoinChange=!0,this.activeScam=null,this.coinsTextControl=null,this.pauseButtonControl=null,this.lastScamId=null,this.gameEnded=!1,this.freezeScams=!1,this.createCommonMaterials(),this.setupPlayer()}var t,n,i;return t=e,(n=[{key:"createCommonMaterials",value:function(){var e=new BABYLON.StandardMaterial("playerMaterial",this.scene);e.diffuseTexture=new BABYLON.Texture("assets/scenes/Standing 1 1.png",this.scene),e.diffuseTexture.hasAlpha=!0,e.backFaceCulling=!0;var t=new BABYLON.StandardMaterial("bulletMaterial",this.scene);t.diffuseColor=new BABYLON.Color3.FromHexString("#887FC0"),t.emissiveColor=new BABYLON.Color3.FromHexString("#887FC0"),t.specularColor=new BABYLON.Color3.FromHexString("#887FC0"),t.alpha=.5,t.freeze(),this.level.addMaterial(e),this.level.addMaterial(t)}},{key:"setupPlayer",value:function(){this.mesh=BABYLON.MeshBuilder.CreateBox("player",{width:1.2,height:1.2,depth:.01},this.scene),this.mesh.position=new BABYLON.Vector3(0,-2.1,0),this.mesh.material=this.level.getMaterial("playerMaterial"),this.changePosition=!0,this.gotCoinSound=this.level.assets.getSound("gotCoinSound"),this.gameLostSound=this.level.assets.getSound("gameLostSound"),this.beginGameSound=this.level.assets.getSound("beginGameSound"),this.infoSound=this.level.assets.getSound("infoSound"),this.scammedSound=this.level.assets.getSound("damageSound"),this.zappingSound=this.level.assets.getSound("zappingSound"),this.winningSound=this.level.assets.getSound("winningSound"),this.selectSound=this.level.assets.getSound("selectSound"),this.movementSound=this.level.assets.getSound("movementSound"),this.groundMesh=BABYLON.MeshBuilder.CreateBox("groundplane",{width:screen.width,height:.1,depth:.01},this.scene),this.groundMesh.position=new BABYLON.Vector3(0,-2.7,0),this.groundMesh.isVisible=!1,this.mesh.material.alpha=0,this.spriteManagerPlayer=[],this.spriteManagerPlayer.left=new BABYLON.SpriteManager("playerManager","assets/scenes/scamman_walk_left.png",1,{width:61,height:60},this.scene),this.spriteManagerPlayer.right=new BABYLON.SpriteManager("playerManager","assets/scenes/scamman_walk_right.png",1,{width:61,height:60},this.scene),this.spriteManagerPlayer.up=new BABYLON.SpriteManager("playerManager","assets/scenes/scamman_attack.png",1,{width:41,height:62},this.scene),this.spriteManagerPlayer.land=new BABYLON.SpriteManager("playerManager","assets/scenes/scamman_land.png",1,{width:118,height:198},this.scene),this.spriteManagerPlayer.lose=new BABYLON.SpriteManager("playerManager","assets/scenes/scam man_lose.png",1,{width:39,height:48},this.scene),this.spriteManagerPlayer.win=new BABYLON.SpriteManager("playerManager","assets/scenes/scam man_win.png",1,{width:66,height:62},this.scene),this.spriteManagerPlayer.shield=new BABYLON.SpriteManager("playerManager","assets/scenes/shield.png",1,{width:61,height:60},this.scene),this.createHUD()}},{key:"createHUD",value:function(){var e=this;this.hud=new l("playerHudUI"),this.coinsTextControl=null,this.pauseButtonControl=null,this.groundImg=this.hud.addImage("groundImage",{imgpath:"assets/scenes/ground_image.png",width:1,isVisible:!0,height:.075,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM}),this.moneyBar=this.hud.addImage("moneyBar",{imgpath:"assets/scenes/moneybar.png",width:.4,height:.05,top:Math.floor(-1*GAME.engine.getRenderHeight()/100),left:Math.floor(2*GAME.engine.getRenderWidth()/100),horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM}),this.potImg=this.hud.addImage("potImage",{imgpath:"assets/scenes/pot.png",width:.09,height:.055,top:Math.floor(-.8*GAME.engine.getRenderHeight()/100),left:Math.floor(-20*GAME.engine.getRenderWidth()/100),horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM}),this.coinsTextControl=this.hud.addText("£ 0",{top:Math.floor(-2.1*GAME.engine.getRenderHeight()/100),left:"4px",fontSize:"16px",fontStyle:"bold",color:"#FFFF99",horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM}),"TutorialLevel"==GAME.currentLevelName&&(this.coinsTextControl.isVisible=!1,this.moneyBar.isVisible=!1,this.potImg.isVisible=!1,this.skipControl=this.hud.addImgButton("SkipBtn",{imgpath:"assets/scenes/Skip_tutorial.png",top:-1*GAME.engine.getRenderHeight()/100,width:.2,height:.05,horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM,onclick:function(){e.gameEnded=!0,clearInterval(e.level.scams.trigger),clearInterval(e.level.boons.trigger),clearInterval(e.level.tutorialTrigger),GAME.goToLevel("RunnerLevel")}}),this.skipControl.isVisible=!1),this.pauseButtonControl=this.hud.addImgButton("PAUSE",{imgpath:"assets/scenes/pause.png",width:.12,height:.08,top:Math.floor(-1.5*GAME.engine.getRenderHeight()/100),left:"-25px",isVisible:!0,horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_RIGHT,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM,onclick:function(){e.selectSound.play(),GAME.pause(),e.resumeButton.isVisible=!0,e.pauseButtonControl.isVisible=!1,e.pausedImage.isVisible=!0,e.level.skipControl&&(e.level.skipControl.isVisible=!1)}}),this.pausedImage=this.hud.addImage("PAUSED",{imgpath:"assets/scenes/PausedScreen.png",width:.5,height:.1,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER}),this.pausedImage.isVisible=!1,this.soundMuteButtonControl=this.hud.addImgButton("MUTE",{imgpath:"assets/scenes/music_on.png",width:.12,height:.08,top:Math.floor(-1.5*GAME.engine.getRenderHeight()/100),left:"25px",isVisible:!0,horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM,onclick:function(){window.localStorage.mute_sound=1,e.soundUnMuteButtonControl.isVisible=!0,e.soundMuteButtonControl.isVisible=!1,BABYLON.Engine.audioEngine.setGlobalVolume(0)}}),this.soundUnMuteButtonControl=this.hud.addImgButton("UNMUTE",{imgpath:"assets/scenes/music_off.png",width:.12,height:.08,top:Math.floor(-1.5*GAME.engine.getRenderHeight()/100),left:"25px",isVisible:!0,horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM,onclick:function(){window.localStorage.mute_sound=0,e.soundUnMuteButtonControl.isVisible=!1,e.soundMuteButtonControl.isVisible=!0,BABYLON.Engine.audioEngine.unlock(),BABYLON.Engine.audioEngine.setGlobalVolume(20)}}),this.resumeButton=this.hud.addImgButton("RESUME",{imgpath:"assets/scenes/Play_Button.png",width:.12,height:.08,top:Math.floor(-1.5*GAME.engine.getRenderHeight()/100),left:"-25px",horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_RIGHT,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM,onclick:function(){e.level.activeMessage||GAME.resume(),e.skipControl&&(e.skipControl.isVisible=!0),e.level.skipControl&&(e.level.skipControl.isVisible=!0),e.pausedImage.isVisible=!1,e.resumeButton.isVisible=!1,e.pauseButtonControl.isVisible=!0}}),this.resumeButton.isVisible=!1}},{key:"keepCoin",value:function(){var e=this;0!=this.lives&&this.allowCoinChange&&(this.coins+=100,this.coins=GAME.options.maxLifetimeAllowance<this.coins?GAME.options.maxLifetimeAllowance:this.coins,this.gotCoinSound.play(),this.coinsTextControl.text="£ "+this.coins,this.coinsTextControl.fontSize="15px",setTimeout((function(){e.coinsTextControl.fontSize="15px"}),500),this.maxCoins=this.coins>this.maxCoins?this.coins:this.maxCoins)}},{key:"handlePot",value:function(){var e="";this.coins&&(e="assets/scenes/pot low.png"),this.coins>2e3&&(e="assets/scenes/pot-1.png"),this.coins>4e3&&(e="assets/scenes/pot-2.png"),this.coins>8e3&&(e="assets/scenes/pot-3.png"),this.coins>1e4&&(e="assets/scenes/pot-4.png"),this.coins>13500&&(e="assets/scenes/pot-full.png"),e&&(this.potImg.source=e,this.potImg.width=.09)}},{key:"checkLife",value:function(){var e=this;if(!this.shielded&&!this.godMode&&"TutorialLevel"!=GAME.currentLevelName)if(this.coins<=1)this.coins=0,this.coinsTextControl.text="£ "+this.coins,this.coinsTextControl.fontSize="15px",this.allowCoinChange=!1,this.onDie&&this.onDie();else{var t=a.message;this.scammedSound.play(),this.scamming=!0;var n=Math.floor(this.coins-t[this.activeScam].reduction),i=Math.floor((this.coins-n)/10),o=setInterval((function(){e.coins-=i,e.coins>n?(e.coinsTextControl.text="£ "+e.coins,e.coinsTextControl.fontSize="15px",e.coinsTextControl.color="#ff0000"):(e.allowCoinChange=!0,e.coinsTextControl.text="£ "+e.coins,e.coinsTextControl.fontSize="15px",e.coinsTextControl.color="#FFFF99",e.scamming=!1,clearInterval(o)),e.coins<=1&&(e.coins=0,e.allowCoinChange=!1,e.scamming=!1,e.coinsTextControl.text="£ "+e.coins,e.coinsTextControl.fontSize="15px",e.coinsTextControl.color="#ff0000",e.onDie&&e.onDie(),clearInterval(o))}),50)}}},{key:"move",value:function(){this.checkDirectionMovement(),this.checkShoot(),this.handlePot(),1==window.localStorage.mute_sound?(this.soundUnMuteButtonControl.isVisible=!0,this.soundMuteButtonControl.isVisible=!1,BABYLON.Engine.audioEngine.setGlobalVolume(0)):(this.soundUnMuteButtonControl.isVisible=!1,this.soundMuteButtonControl.isVisible=!0,BABYLON.Engine.audioEngine.unlock(),BABYLON.Engine.audioEngine.setGlobalVolume(20))}},{key:"checkDirectionMovement",value:function(){var e=this;if(GAME.keys.left&&!this.gameEnded&&!this.playerLanding&&this.changePosition&&this.mesh.position.x>(GAME.isMobile(),-1)){this.movementSound.play(),this.changePosition=!1,this.shootAction&&(this.shootAction.dispose(),clearInterval(this.shootTrigger));var t=new BABYLON.Sprite("player",this.spriteManagerPlayer.left);t.playAnimation(0,7,!0,60),t.position=this.mesh.position,t.size=1.15,t.isPickable=!0;var n=setInterval((function(){t.position=e.mesh.position}),20);this.mesh.animations=[],this.mesh.animations.push(this.createPlayerSideMotion("left",this.mesh.position.x)),this.scene.beginAnimation(this.mesh,0,100,!1),setTimeout((function(){e.changePosition=!0,clearInterval(n),t.dispose()}),100)}if(GAME.keys.right&&!this.gameEnded&&!this.playerLanding&&this.changePosition&&this.mesh.position.x<(GAME.isMobile(),1)){this.movementSound.play(),this.changePosition=!1,this.shootAction&&(this.shootAction.dispose(),clearInterval(this.shootTrigger));var i=new BABYLON.Sprite("player",this.spriteManagerPlayer.right);i.playAnimation(0,7,!0,40),i.position=this.mesh.position,i.size=1.15,i.isPickable=!0;var o=setInterval((function(){i.position=e.mesh.position}),20);this.mesh.animations=[],this.mesh.animations.push(this.createPlayerSideMotion("right",this.mesh.position.x)),this.scene.beginAnimation(this.mesh,0,100,!1),setTimeout((function(){e.changePosition=!0,clearInterval(o),i.dispose()}),100)}}},{key:"createPlayerSideMotion",value:function(e,t){for(var n=new BABYLON.Animation("playerSideMotion","position.x",1e3,BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE),i=[],o=0,s=0,a=0;a<5;a++)s+="left"==e?(GAME.isMobile(),-.2):(GAME.isMobile(),.2),i.push({frame:o,value:t+s}),o+=15;return n.setKeys(i),n}},{key:"checkShoot",value:function(){var e=this;if(GAME.keys.shoot&&!this.beamEnabled&&this.changePosition&&!this.gameEnded&&!this.playerLanding){this.bullet&&(this.bullet.isVisible=!1),this.bullet=BABYLON.Mesh.CreateCylinder("bullet_"+this.bullerCounter++,3,1,.05,0,0,this.scene);var t=this.mesh.getAbsolutePosition().clone();this.bullet.position.x=t.x,this.bullet.position.y=-.3,this.bullet.material=this.level.getMaterial("bulletMaterial"),this.level.light.excludedMeshes.push(this.bullet),this.beamEnabled=!0,this.shootAction&&(this.shootAction.dispose(),clearInterval(this.shootTrigger)),this.shootAction=new BABYLON.Sprite("player",this.spriteManagerPlayer.up),this.shootAction.playAnimation(0,3,!1,25),this.shootAction.position.x=this.mesh.position.x+.2,this.shootAction.position.y=this.mesh.position.y-.1,this.shootAction.position.z=this.mesh.position.z,this.shootAction.size=1,this.shootAction.isPickable=!0,this.shootTrigger=setInterval((function(){e.shootAction.position.x=e.mesh.position.x+.2,e.shootAction.position.y=e.mesh.position.y-.1,e.shootAction.position.z=e.mesh.position.z}),24),setTimeout((function(){e.bullet.dispose(),e.beamEnabled=!1,e.shootAction.dispose(),clearInterval(e.shootTrigger)}),700);var n=setInterval((function(){e.changePosition||(e.bullet.dispose(),e.beamEnabled=!1,clearInterval(n))}),100)}}},{key:"getMesh",value:function(){return this.mesh}},{key:"getPoints",value:function(){return this.checkAndSaveRecord(this.coins),this.coins}},{key:"keepScam",value:function(e){this.zappingSound.play(),this.lastScamId!==e&&(this.lastScamId=e,this.scamCount++)}},{key:"keepBoon",value:function(e){var t=this;this.boonCount++,this.gotCoinSound.play(),"invisiblity_boon"==e&&(this.shielded=10,this.shieldTrigger&&(this.shieldSprite.dispose(),clearInterval(this.maintainPositionTrigger),clearInterval(this.shieldTrigger)),this.shieldSprite=new BABYLON.Sprite("shieldSprite",this.spriteManagerPlayer.shield),this.shieldSprite.playAnimation(0,7,!0,100),this.shieldSprite.position=this.mesh.position,this.shieldSprite.size=1.15,this.maintainPositionTrigger=setInterval((function(){t.shieldSprite.position=t.mesh.position,t.beamEnabled?t.shieldSprite.isVisible=!1:t.shieldSprite.isVisible=!0}),100),this.shieldTrigger=setInterval((function(){t.shielded--,t.shielded||(t.shieldSprite.dispose(),clearInterval(t.maintainPositionTrigger),clearInterval(t.shieldTrigger))}),1e3));var n=a.message,i=Math.floor(this.coins+n[e].addition);i=i>GAME.options.maxLifetimeAllowance?GAME.options.maxLifetimeAllowance:i;var o=Math.floor((i-this.coins)/10);if(o)var s=setInterval((function(){t.coins+=o,t.maxCoins=t.coins>t.maxCoins?t.coins:t.maxCoins,t.coins<i&&t.allowCoinChange?(t.coinsTextControl.text="£ "+t.coins,t.coinsTextControl.fontSize="15px",t.coinsTextControl.color="green"):(t.coins=t.lives>0?i:0,t.coinsTextControl.text="£ "+t.coins,t.coinsTextControl.fontSize="15px",t.coinsTextControl.color="#FFFF99",clearInterval(s))}),50)}},{key:"checkAndSaveRecord",value:function(e){var t=0;this.pointsRecord=!1,window.localStorage.last_record&&(t=parseInt(window.localStorage.last_record,10)),t<e&&(this.pointsRecord=!0,window.localStorage.last_record=e)}},{key:"hasMadePointsRecord",value:function(){return this.pointsRecord}},{key:"getLastRecord",value:function(){return window.localStorage.last_record||0}},{key:"reset",value:function(){this.coins=0,this.maxCoins=0,this.mesh.position.x=0,this.scamCount=0,this.boonCount=0,this.lives=GAME.options.player.lives,this.coinsTextControl.text="£ "+this.coins,this.allowCoinChange=!0,this.pauseButtonControl.isVisible=!0}},{key:"landPlayer",value:function(){var e=this;this.playerLanding=!0,this.beginGameSound.play(),this.landAction=new BABYLON.Sprite("land",this.spriteManagerPlayer.land),this.landAction.position=new BABYLON.Vector3(.18,-.7,0),this.landAction.height=4,this.landAction.width=2.25,this.landAction.playAnimation(0,11,!1,100,(function(){e.mesh.material.alpha=1,e.playerLanding=!1,e.level.freezeGeneration=!1,e.landAction.dispose()})),this.landAction.isPickable=!0,this.mesh.position.x=0}}])&&c(t.prototype,n),i&&c(t,i),e}();function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var d=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.meshes=[],this.sounds=[],this.manager=new BABYLON.AssetsManager(this.scene),this.manager.onFinish=function(e){n&&n(e)}}var t,n,i;return t=e,(n=[{key:"addSound",value:function(e,t,n){var i=this;return this.manager.addBinaryFileTask(e+"__SoundTask",t).onSuccess=function(t){i.sounds[e]=new BABYLON.Sound(e,t.data,i.scene,null,n),n.onSuccess&&n.onSuccess(i.sounds[e])},this.sounds[e]}},{key:"addMusic",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.loop=void 0===n.loop||n.loop,n.volume=void 0!==n.volume?n.volume:.3,n.autoplay=void 0!==n.autoplay&&n.autoplay,this.addSound(e,t,n)}},{key:"addMesh",value:function(){}},{key:"getMesh",value:function(e){return this.meshes[e]}},{key:"getSound",value:function(e){return this.sounds[e]}},{key:"load",value:function(){this.manager.load()}}])&&u(t.prototype,n),i&&u(t,i),e}();function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var g=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.materials={},this.scene=null,this.assets=null}var t,n,i;return t=e,(n=[{key:"start",value:function(){GAME.resume(),GAME.stopRenderLoop(),this.setProperties?this.setProperties():GAME.log.debugWarning("The setProperties method is recommended to initialize the Level properties"),this.createScene()}},{key:"createScene",value:function(){var e=this;GAME.engine.displayLoadingUI(),this.scene=new BABYLON.Scene(GAME.engine);var t="";return t="RunnerLevel"===GAME.currentLevelName||"TutorialLevel"===GAME.currentLevelName?"assets/scenes/game_bg_dark.png":"assets/scenes/Start_screen_background.png",new BABYLON.Layer("back",t,this.scene).isBackground=!0,this.assets=new d(this.scene,(function(){GAME.log.debug("Level Assets loaded"),e.buildScene?e.buildScene():GAME.log.debugWarning("You can add the buildScene method to your level to define your scene"),e.beforeRender?e.scene.registerBeforeRender(e.beforeRender.bind(e)):GAME.log.debugWarning("You can define animations and other game logics that happends inside the main loop on the beforeRender method"),GAME.startRenderLoop()})),this.setupAssets&&this.setupAssets(),this.assets.load(),BABYLON.Engine.audioEngine.onAudioLockedObservable.add((function(){GAME.log.debugWarning("Sounds are locked. Please refresh cache")})),BABYLON.Engine.audioEngine.onAudioUnlockedObservable.add((function(){})),this.scene}},{key:"exit",value:function(){this.scene.dispose(),this.scene=null}},{key:"addMaterial",value:function(e){this.materials[e.name]=e}},{key:"getMaterial",value:function(e){return this.materials[e]}},{key:"removeMaterial",value:function(e){var t=null;(t=this.materials[e])&&(t.dispose(),delete this.materials[e])}}])&&p(t.prototype,n),i&&p(t,i),e}();function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var A=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.level=t,this.scene=t.scene,this.player=t.player,this.activeCoins=[],this.createCommonMaterials()}var t,n,i;return t=e,(n=[{key:"createCommonMaterials",value:function(){var e=new BABYLON.StandardMaterial("coinMaterial",this.scene);e.diffuseTexture=new BABYLON.Texture("assets/scenes/coin.png",this.scene),e.diffuseTexture.hasAlpha=!0,e.backFaceCulling=!0,this.level.addMaterial(e)}},{key:"generate",value:function(){var e=this;setInterval((function(){!GAME.isPaused()&&e.player.lives&&e.level.age<65&&!e.level.freezeGeneration&&e.createCoins()}),2e3)}},{key:"createCoins",value:function(){var e=this,t=Math.floor(100*Math.random()),n=0;t>=0&&t<30&&(GAME.isMobile(),n=-1),t>=30&&(n=0),t>=60&&(GAME.isMobile(),n=1),this.activeCoins.push(t);var i=BABYLON.Mesh.CreateCylinder("coin",.01,.32,.32,16,0,this.scene);i.material=this.level.getMaterial("coinMaterial"),i.position.x=n,i.position.y=3,i.position.z=0,i.rotation.x=4.712,i.animations.push(this.createCoinAnimation());var o=this.scene.beginAnimation(i,0,2e3,!1),s=this.player.getMesh(),a=this.player.groundMesh,r=setInterval((function(){a.intersectsMesh(i,!1)&&(i.dispose(),e.removeActiveCoin(t),clearInterval(r)),s.intersectsMesh(i,!1)&&(e.player.keepCoin(),i.dispose(),e.removeActiveCoin(t),clearInterval(r)),(!e.player.lives||e.level.age>=65)&&(i.dispose(),e.removeActiveCoin(t),clearInterval(r)),GAME.isPaused()&&(i.paused=!0,o.pause()),!GAME.isPaused()&&i.paused&&o.restart()}),10);setTimeout((function(){var n=setInterval((function(){GAME.isPaused||(o.pause(),i.dispose(),e.removeActiveCoin(t),clearInterval(n))}),100)}),2e4),GAME.isPaused()&&o.pause()}},{key:"createCoinAnimation",value:function(){var e=new BABYLON.Animation("coinfall","position.y",this.level.getGameSpeed(),BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE),t=[];return t.push({frame:0,value:3}),t.push({frame:15,value:1.5}),t.push({frame:30,value:0}),t.push({frame:45,value:-1.5}),t.push({frame:60,value:-3}),t.push({frame:85,value:-4.5}),e.setKeys(t),e}},{key:"removeActiveCoin",value:function(e){var t=this.activeCoins.indexOf(e);-1!==t&&this.activeCoins.splice(t,1)}}])&&m(t.prototype,n),i&&m(t,i),e}(),v=n("4lKV");function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.decision=!0,this.level=t,this.scene=t.scene,this.player=t.player,this.createCommonMaterials(),this.scamSet=new Set,this.scamTypes=[],this.activeScams=[]}var t,n,i;return t=e,(n=[{key:"createCommonMaterials",value:function(){var e=new BABYLON.StandardMaterial("scamMaterial",this.scene);e.diffuseTexture=new BABYLON.Texture("assets/scenes/Cold_call_v2.png",this.scene),e.diffuseTexture.hasAlpha=!0,e.backFaceCulling=!0,this.level.addMaterial(e)}},{key:"generate",value:function(){var e=this;this.trigger=setInterval((function(){if(!GAME.isPaused()&&e.player.lives&&e.level.age<65&&!e.level.freezeGeneration&&e.scene&&!e.player.freezeScams){e.scamTypes=[];for(var t=1;t<=e.level.nextStage;t++){var n=e.level.nextStage-t;(n||"TutorialLevel"===GAME.currentLevelName)&&v["stage_"+n].scams.forEach((function(t){-1===e.scamTypes.indexOf(t)&&e.scamTypes.push(t)}))}var i=Math.floor(Math.random()*e.scamTypes.length),o=e.scamTypes[i];o&&(e.player.activeScam=o,"TutorialLevel"!==GAME.currentLevelName||e.scamSet.size||e.level.createTutorialText(5),e.activeScams.push(i),"splitter"==o?e.createSplitterScams(i):e.createScams(o,i),e.scamSet.has(o)||e.scamSet.add(o))}}),4e3)}},{key:"createScams",value:function(e,t){var n=this,i=Math.floor(100*Math.random()),o=0;i>=0&&i<30&&(GAME.isMobile(),o=-1),i>=30&&(o=0),i>=60&&(GAME.isMobile(),o=1);var s=(GAME.isMobile(),.45),r=BABYLON.MeshBuilder.CreateBox("scam_"+i,{width:s,height:s-.01,depth:.001},this.scene),l=a.message[e].path;r.material=this.level.getMaterial("scamMaterial").clone("scam_material"+i),r.material.diffuseTexture=new BABYLON.Texture(l,this.scene),r.material.diffuseTexture.hasAlpha=!0,r.position.x=o,r.position.y=3,r.position.z=0,"zig_zag"==e?r.animations.push(this.createZigZagScamAnimation(r)):"normal_scam"==e||"generic_scam"==e?r.animations.push(this.createScamAnimation()):"speedy"==e?r.animations.push(this.createSpeedyScamAnimation()):"accelerator"==e?r.animations.push(this.createAcceleratorScamAnimation()):"black_out"==e?r.animations.push(this.createBlackoutAnimation()):"diagonal"==e&&r.animations.push(this.createDiagonalScamAnimation(r));var c=this.scene.beginAnimation(r,0,2e3,!1),h=setInterval((function(){if(n.player.getMesh(),r){var e=[];n.scene.meshes.forEach((function(o){o.name.includes("bullet")&&!e.includes(o.name)&&(e.push(o.name),o.intersectsMesh(r,!1)&&(r.dispose(),clearInterval(n.blackOutTrigger),setTimeout((function(){o.dispose(),n.removeActiveScam(t),clearInterval(h),n.player.shootAction.dispose(),clearInterval(n.player.shootTrigger),n.player.beamEnabled=!1}),200),n.player.keepScam(i)))})),n.player.groundMesh.intersectsMesh(r,!1)?(n.player.checkLife(),r.dispose(),n.removeActiveScam(t),clearInterval(h)):n.player.mesh.intersectsMesh(r,!1)&&(n.player.checkLife(),r.dispose(),n.removeActiveScam(t),clearInterval(h)),(!n.player.lives||n.level.age>=65)&&(r.dispose(),n.removeActiveScam(t),clearInterval(h)),GAME.isPaused()&&(r.paused=!0,c.pause()),!GAME.isPaused()&&r.paused&&c.restart()}else n.removeActiveScam(t),clearInterval(h)}),5);setTimeout((function(){var e=setInterval((function(){GAME.isPaused||(c.pause(),r.dispose(),n.removeActiveScam(t),clearInterval(e))}),100)}),1e4)}},{key:"createScamAnimation",value:function(){for(var e=new BABYLON.Animation("scamfall","position.y",this.level.getGameSpeed()-5,BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE),t=[],n=3,i=0;i<6;i++)t.push({frame:15*i,value:n}),n-=1.5;return e.setKeys(t),e}},{key:"createZigZagScamAnimation",value:function(e){for(var t=new BABYLON.Animation("scamfall","position",this.level.getGameSpeed()-5,BABYLON.Animation.ANIMATIONTYPE_VECTOR3,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE),n=[],i=e.position,o=1,s=0;s<8;s++)n.push({frame:15*s,value:i}),i.x==(GAME.isMobile(),1)?o=-1:i.x==(GAME.isMobile(),-1)&&(o=1),i=i.add(new BABYLON.Vector3((GAME.isMobile(),1*o),-1,0));t.setKeys(n);var a=new BABYLON.CircleEase;return a.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEIN),t.setEasingFunction(a),t}},{key:"createSpeedyScamAnimation",value:function(){var e=new BABYLON.Animation("scamfall","position.y",this.level.getGameSpeed()-15,BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE),t=[];return t.push({frame:0,value:3}),t.push({frame:30,value:-3}),e.setKeys(t),e}},{key:"createAcceleratorScamAnimation",value:function(){var e=new BABYLON.Animation("scamfall","position.y",this.level.getGameSpeed()-10,BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE),t=[];return t.push({frame:0,value:3}),t.push({frame:15,value:1.5}),t.push({frame:30,value:-3}),e.setKeys(t),e}},{key:"createBlackoutAnimation",value:function(){var e=this,t="distort1.png";return this.blackOutTrigger=setInterval((function(){!GAME.isPaused()&&e.player.lives&&e.level.age<65&&(t="distort1.png"==t?"distort2.png":"distort1.png")}),500),this.createScamAnimation()}},{key:"createDiagonalScamAnimation",value:function(e){for(var t=new BABYLON.Animation("scamfall","position",this.level.getGameSpeed()-5,BABYLON.Animation.ANIMATIONTYPE_VECTOR3,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE),n=[],i=e.position,o=0;o<5;o++)n.push({frame:15*o,value:i}),1==o&&0!=i.x?i=i.x==(GAME.isMobile(),1)?i.add(new BABYLON.Vector3(-2*(GAME.isMobile(),1),-1.5,0)):i.add(new BABYLON.Vector3(2*(GAME.isMobile(),1),-1.5,0)):4==o&&0!=i.x||(i=i.add(new BABYLON.Vector3(0,-1.5,0)));t.setKeys(n);var s=new BABYLON.CircleEase;return s.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEIN),t.setEasingFunction(s),t}},{key:"createSplitterScams",value:function(e){for(var t=this,n=[],i=[],o=function(o){var s=Math.floor(100*Math.random()),r=(GAME.isMobile(),.45);n[o]=BABYLON.MeshBuilder.CreateBox("scam_"+s,{width:r,height:r-.01,depth:.001},t.scene);var l=a.message.splitter.path;n[o].material=t.level.getMaterial("scamMaterial").clone("scam_material"+s),n[o].material.diffuseTexture=new BABYLON.Texture(l,t.scene),n[o].material.diffuseTexture.hasAlpha=!0,n[o].position.x=0,n[o].position.y=3,n[o].position.z=0,n[o].animations.push(t.createSplitterAnimation(n[o],1==o?"right":"left",o));var c=t.scene.beginAnimation(n[o],0,2e3,!1);i[o]=setInterval((function(){if(t.player.getMesh(),n[o]){var a=[];t.scene.meshes.forEach((function(r){r.name.includes("bullet")&&!a.includes(r.name)&&(a.push(r.name),r.intersectsMesh(n[o],!1)&&(n[o].dispose(),clearInterval(t.blackOutTrigger),setTimeout((function(){r.dispose(),t.removeActiveScam(e),clearInterval(i[o]),t.player.shootAction.dispose(),clearInterval(t.player.shootTrigger),t.player.beamEnabled=!1}),200),t.player.keepScam(s)))})),t.player.groundMesh.intersectsMesh(n[o],!1)?(t.player.checkLife(),n[o].dispose(),t.removeActiveScam(e),clearInterval(i[o])):t.player.mesh.intersectsMesh(n[o],!1)&&(t.player.checkLife(),n[o].dispose(),t.removeActiveScam(e),clearInterval(i[o])),(!t.player.lives||t.level.age>=65)&&(n[o].dispose(),t.removeActiveScam(e),clearInterval(i[o])),GAME.isPaused()&&(n[o].paused=!0,c.pause()),!GAME.isPaused()&&n[o].paused&&c.restart()}else t.removeActiveScam(e),clearInterval(i[o])}),5),setTimeout((function(){var i=setInterval((function(){GAME.isPaused||(c.pause(),n[o].dispose(),t.removeActiveScam(e),clearInterval(i))}),100)}),8e3)},s=0;s<2;s++)o(s)}},{key:"createSplitterAnimation",value:function(e,t){for(var n=new BABYLON.Animation("scamfall","position",this.level.getGameSpeed()-12,BABYLON.Animation.ANIMATIONTYPE_VECTOR3,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE),i=[],o=e.position,s=0;s<7;s++)i.push({frame:15*s,value:o}),1==s&&"right"==t?(o=o.add(new BABYLON.Vector3((GAME.isMobile(),1),-1.5,0)),this.decision=!this.decision):o=1==s?o.add(new BABYLON.Vector3((GAME.isMobile(),-1),-1.5,0)):0==s?o.add(new BABYLON.Vector3(0,-.8,0)):this.decision?o.add(new BABYLON.Vector3(0,-1,0)):o.add(new BABYLON.Vector3(0,-1.5,0));n.setKeys(i);var a=new BABYLON.CircleEase;return a.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEIN),n.setEasingFunction(a),n}},{key:"removeActiveScam",value:function(e){var t=this.activeScams.indexOf(e);-1!==t&&this.activeScams.splice(t,1)}}])&&f(t.prototype,n),i&&f(t,i),e}();function B(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var L=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.level=t,this.scene=t.scene,this.player=t.player,this.createCommonMaterials(),this.typeOfBoon=0,this.texture=null,this.boonSet=new Set,this.lastTwoBoons=[],this.boonTypes=["invisiblity_boon","life_boon"],this.activeBoons=[]}var t,n,i;return t=e,(n=[{key:"createCommonMaterials",value:function(){this.boonMaterial=new BABYLON.StandardMaterial("boonMaterial",this.scene),this.boonMaterial.diffuseTexture=new BABYLON.Texture("assets/scenes/Refuse_v2.png",this.scene),this.boonMaterial.diffuseTexture.hasAlpha=!0,this.boonMaterial.backFaceCulling=!0,this.level.addMaterial(this.boonMaterial)}},{key:"generate",value:function(){var e=this;this.trigger=setInterval((function(){if(!GAME.isPaused()&&e.player&&e.player.lives&&e.level.age<65&&!e.level.freezeGeneration&&e.scene){e.boonTypes=[];for(var t=1;t<=e.level.nextStage;t++)(e.level.nextStage-t||"TutorialLevel"===GAME.currentLevelName)&&v["stage_"+(e.level.nextStage-t)].boons.forEach((function(t){-1===e.boonTypes.indexOf(t)&&e.boonTypes.push(t)}));for(var n=Math.floor(Math.random()*e.boonTypes.length),i=e.boonTypes[n];e.lastTwoBoons.includes("invisiblity_boon")&&"invisiblity_boon"==i;)n=Math.floor(Math.random()*e.boonTypes.length),i=e.boonTypes[n];2===e.lastTwoBoons.length&&e.lastTwoBoons.shift(),e.lastTwoBoons.push(i),"TutorialLevel"!==GAME.currentLevelName||e.typeOfBoon||e.level.createTutorialText(6),e.activeBoons.push(n),e.typeOfBoon++;var o=a.message[i].path;e.texture=new BABYLON.Texture(o,e.scene),e.boonMaterial.diffuseTexture=e.texture,e.boonMaterial.diffuseTexture.hasAlpha=!0,e.createBoons(i,n),e.boonSet.has(i)||e.boonSet.add(i)}}),"TutorialLevel"===GAME.currentLevelName?4e3:11e3)}},{key:"createBoons",value:function(e,t){var n=this,i=Math.floor(100*Math.random()),o=0;i>=0&&i<30&&(GAME.isMobile(),o=-1),i>=30&&(o=0),i>=60&&(GAME.isMobile(),o=1);var s=(GAME.isMobile(),.45),a=BABYLON.MeshBuilder.CreateBox("boon_"+i,{width:s,height:s-.01,depth:.001},this.scene);a.material=this.level.getMaterial("boonMaterial"),a.material.diffuseTexture.hasAlpha=!0,a.position.x=o,a.position.y=3,a.position.z=0,a.animations.push(this.createBoonAnimation());var r=this.scene.beginAnimation(a,0,2e3,!1),l=setInterval((function(){var i=n.player.getMesh();if(a){var o=[];n.scene.meshes.forEach((function(e){e.name.includes("bullet")&&!o.includes(e.name)&&(o.push(e.name),e.intersectsMesh(a,!1)&&(a.dispose(),setTimeout((function(){e.dispose(),n.removeActiveBoon(t),clearInterval(l),n.player.shootAction.dispose(),clearInterval(n.player.shootTrigger),n.player.beamEnabled=!1}),200)))})),i.intersectsMesh(a,!1)?(a.dispose(),n.player.keepBoon(e),n.removeActiveBoon(t),clearInterval(l)):n.player.groundMesh.intersectsMesh(a,!1)&&(a.dispose(),n.removeActiveBoon(t),clearInterval(l)),(!n.player.lives||n.level.age>=65)&&(a.dispose(),n.removeActiveBoon(t),clearInterval(l)),GAME.isPaused()&&(a.paused=!0,r.pause()),!GAME.isPaused()&&a.paused&&r.restart()}else n.removeActiveBoon(t),clearInterval(l)}),5);setTimeout((function(){var e=setInterval((function(){GAME.isPaused||(r.pause(),a.dispose(),n.removeActiveBoon(t),clearInterval(e))}),100)}),15e3)}},{key:"createBoonAnimation",value:function(){var e=new BABYLON.Animation("boonfall","position.y",this.level.getGameSpeed()-5,BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE),t=[];return t.push({frame:0,value:3}),t.push({frame:15,value:1.5}),t.push({frame:30,value:0}),t.push({frame:45,value:-1.5}),t.push({frame:60,value:-3}),t.push({frame:85,value:-4.5}),e.setKeys(t),e}},{key:"removeActiveBoon",value:function(e){var t=this.activeBoons.indexOf(e);-1!==t&&this.activeBoons.splice(t,1)}}])&&B(t.prototype,n),i&&B(t,i),e}();function T(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var N=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.level=t,this.scene=t.scene,this.player=t.player,this.progressValue=null,this.ageControl=null,this.progressValueInvisible=null,this.advancedTexture=null,this.setupTimer()}var t,n,i;return t=e,(n=[{key:"setupTimer",value:function(){var e=this;this.advancedTexture=BABYLON.GUI.AdvancedDynamicTexture.CreateFullscreenUI("UI",!1);var t=new BABYLON.GUI.Rectangle;t.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,t.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,t.width=1,t.height="50px",t.thickness=0,t.background="#45186e",this.advancedTexture.addControl(t);var n=new BABYLON.GUI.Rectangle;n.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,n.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,n.top="15px",n.width=.8,n.height="45px",n.thickness=0,this.advancedTexture.addControl(n);var i=new BABYLON.GUI.Rectangle;i.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,i.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,i.top="15px",i.width=.8,i.height="25px",i.cornerRadius=40,i.color="#935DB6",i.thickness=3,i.background="white";var o=new BABYLON.GUI.Image("image","assets/scenes/stripe.jpg");o.alpha=.2,i.addControl(o);var s=new BABYLON.GUI.Rectangle;s.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,s.width=1,s.left="0px",s.height="15px",s.cornerRadius=100,s.color="#DDDBE0",s.thickness=0,s.background="#DDDBE0",s.alpha=.6,i.addControl(s),this.progressValue=new BABYLON.GUI.Rectangle,this.progressValue.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,this.progressValue.width=0,this.progressValue.left="0px",this.progressValue.height=1,this.progressValue.cornerRadius=20,this.progressValue.color="#EBC514",this.progressValue.thickness=0,this.progressValue.background="#EBC514",i.addControl(this.progressValue),this.advancedTexture.addControl(i),this.progressValueInvisible=new BABYLON.GUI.Rectangle,this.progressValueInvisible.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,this.progressValueInvisible.width=0,this.progressValueInvisible.thickness=0,n.addControl(this.progressValueInvisible),this.ageControl=new BABYLON.GUI.TextBlock,this.ageControl.textHorizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,this.ageControl.textVerticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER,this.ageControl.text="18",this.ageControl.color="#DDDBE0",this.ageControl.fontSize=10,this.ageControl.isVisible=!1,this.progressValue.addControl(this.ageControl);for(var a=1;a<=4;a++){var r=new BABYLON.GUI.Rectangle;r.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,r.width=.334*a,r.height=1,r.thickness=3,r.color="#CCCACE",r.background="transparent",s.addControl(r)}var l=0,c=0,h=GAME.options.gameLength;this.trigger=setInterval((function(){if(c<47){if(!GAME.isPaused()){l+=98/h/100/10,c+=47/h/10,e.progressValue.width=l,e.progressValueInvisible.width=l+.01;var t=Math.round(18+c);e.ageControl.text=""+t,e.ageControl.alpha=t>63||t<23?0:1}}else e.player.win(),clearInterval(e.trigger)}),100)}},{key:"clear",value:function(){clearInterval(this.trigger),this.advancedTexture.dispose()}}])&&T(t.prototype,n),i&&T(t,i),e}();function E(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var C=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.level=t,this.scene=t.scene,this.player=t.player}var t,n,i;return t=e,(n=[{key:"addText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new BABYLON.GUI.TextBlock;return n.text=e,n.color=t.color||"black",n.fontSize=t.fontSize||20,n.fontStyle=t.fontStyle||"",n.outlineWidth=t.outlineWidth||0,n.outlineColor=t.outlineColor||"black",n.lineSpacing=t.lineSpacing||"0px",n.left=t.left||"0px",n.paddingRight=t.paddingRight||"10px",n.top=t.top||"0px",n.textHorizontalAlignment=void 0!==t.horizontalAlignment?t.horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,n.textVerticalAlignment=void 0!==t.verticalAlignment?t.verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,n.textWrapping=t.wrapping||!0,n.fontFamily=t.fontFamily||"'Tomorrow', sans-serif",n}},{key:"showStage",value:function(e){var t=this;GAME.pause();var n=!0;GAME.options.messageReadTime,this.scamsHeading=[],this.scamsMessage=[],this.scamsImage=[];var i=new l("stageLoadingUI"),o=v["stage_"+e];if(i.addImage("stageScreen",{imgpath:"assets/scenes/stage_boarder.png",width:1,height:1}),this.stageUI=new BABYLON.GUI.Rectangle,this.stageUI.width=.9,this.stageUI.height=1,this.stageUI.thickness=0,this.stageUI.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,i.menuTexture.addControl(this.stageUI),o){if(o.message&&(this.gameSubTextControl=this.addText(o.message,{top:"-140px",fontSize:"15px",verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER}),this.stageUI.addControl(this.gameSubTextControl)),o.instruction&&(this.gameInstructionControl=this.addText(o.instruction,{top:"-60px",fontSize:"15px",verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER}),this.stageUI.addControl(this.gameInstructionControl)),i.addImgButton("continueBtn",{imgpath:"assets/scenes/Continue.png",top:-4*GAME.engine.getRenderHeight()/100,width:.2,height:.05,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM,onclick:function(){t.player.selectSound.play(),n&&(t.player.coinsTextControl.isVisible=!0,t.player.pausedImage.isVisible=!1,t.player.resumeButton.isVisible=!1,t.player.pauseButtonControl.isVisible=!0,i.clear(),t.player.gameEnded||(GAME.resume(),t.player.landPlayer()),n=!1)}}),o.scams){this.levelImage=new BABYLON.GUI.Image("levelImage",o.path),this.levelImage.width=.3,this.levelImage.height=GAME.isMobile()?.05:.07,this.levelImage.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,this.levelImage.top=3*GAME.engine.getRenderHeight()/100,this.stageUI.addControl(this.levelImage),this.scamDescription=this.addText("Shine your torch and avoid the following scams! ",{top:10*GAME.engine.getRenderHeight()/100,color:GAME.options.pointsTextColor,fontSize:"15px",fontStyle:"bold",verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,textVerticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER}),this.stageUI.addControl(this.scamDescription),2==e&&(this.warningMessage=this.addText("*This bonus will make you temporarily invincible",{top:-10*GAME.engine.getRenderHeight()/100,color:GAME.options.pointsTextColor,fontSize:"11px",fontStyle:"bold",verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM,textVerticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER}),this.stageUI.addControl(this.warningMessage));var s=10.5*GAME.engine.getRenderWidth()/100,r=4*GAME.engine.getRenderWidth()/100;o.scams.forEach((function(e){var n=new BABYLON.GUI.Image("icon",a.message[e].path);n.width=.2,n.height=.1,n.top=18*GAME.engine.getRenderHeight()/100,n.left=s,n.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,n.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,t.stageUI.addControl(n);var i=new BABYLON.GUI.Rectangle;i.width=.37,i.height=.22,i.thickness=0,i.left=r,i.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,i.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,i.top=28.5*GAME.engine.getRenderHeight()/100,t.stageUI.addControl(i);var o=t.addText(a.message[e].name,{top:"0px",fontSize:"11px",left:"1px",fontStyle:"bold",horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER}),l=t.addText(a.message[e].info,{top:"30px",fontSize:"11px",left:"1px",horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER});s+=55*GAME.engine.getRenderWidth()/100,r+=55*GAME.engine.getRenderWidth()/100,t.scamsHeading.push(o),t.scamsMessage.push(l),t.scamsImage.push(n),i.addControl(o),i.addControl(l)}))}this.player.coinsTextControl.isVisible=!1,i.show()}this.setBoons(o)}},{key:"setBoons",value:function(e){var t=this;this.stageUI.addControl(this.addText("Collect bonus points for good scam awareness!",{top:50*GAME.engine.getRenderHeight()/100,color:GAME.options.pointsTextColor,fontSize:"15px",fontStyle:"bold",verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP}));var n=10.5*GAME.engine.getRenderWidth()/100,i=4*GAME.engine.getRenderWidth()/100;e.boons.forEach((function(e){var o=new BABYLON.GUI.Image("icon",a.message[e].path);o.width=.2,o.height=.1,o.top=58*GAME.engine.getRenderHeight()/100,o.left=n,o.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,o.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,t.stageUI.addControl(o);var s=new BABYLON.GUI.Rectangle;s.width=.37,s.height=.22,s.thickness=0,s.left=i,s.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,s.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,s.top=69*GAME.engine.getRenderHeight()/100,t.stageUI.addControl(s);var r=t.addText(a.message[e].name,{top:"0px",fontSize:"11px",left:"1px",fontStyle:"bold",horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER}),l=t.addText(a.message[e].info,{top:"30px",fontSize:"11px",left:"1px",horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER});n+=55*GAME.engine.getRenderWidth()/100,i+=55*GAME.engine.getRenderWidth()/100,s.addControl(r),s.addControl(l)}))}}])&&E(t.prototype,n),i&&E(t,i),e}();function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function b(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var S=function(e){function t(){return M(this,t),b(this,w(t).apply(this,arguments))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,e),n=t,(i=[{key:"setProperties",value:function(){this.player=null,this.tiles=null,this.menu=null,this.pointsTextControl=null,this.currentRecordTextControl=null,this.hasMadeRecordTextControl=null,this.status=null,this.currentStageAge=0,this.nextStage=1,this.speed=GAME.options.player.defaultSpeed}},{key:"setupAssets",value:function(){this.assets.addMusic("music","assets/musics/SCAM_MAN_background2.wav",{volume:.0025,autoplay:!0}),this.assets.addSound("gameLostSound","assets/sounds/game-lost.wav",{volume:.01}),this.assets.addSound("gotCoinSound","assets/sounds/coin_going_into_pot.wav",{volume:8e-4}),this.assets.addSound("beginGameSound","assets/sounds/begin_game.wav",{volume:.0015}),this.assets.addSound("infoSound","assets/sounds/info.wav",{volume:.001}),this.assets.addSound("damageSound","assets/sounds/scammed.wav",{volume:.001}),this.assets.addSound("movementSound","assets/sounds/movement.wav",{volume:.002}),this.assets.addSound("zappingSound","assets/sounds/Zapping_Scam.wav",{volume:3e-4}),this.assets.addSound("winningSound","assets/sounds/Winning_Sound.wav",{volume:.001}),this.assets.addSound("splashScreenSound","assets/sounds/Winning_Sound.wav",{volume:.001}),this.assets.addSound("selectSound","assets/sounds/Select_sound.wav",{volume:.001})}},{key:"buildScene",value:function(){var e=this;this.scene.clearColor=new BABYLON.Color3.FromHexString(GAME.options.backgroundColor),this.createMenus();var t=this.createCamera();this.scene.activeCamera=t,this.light=new BABYLON.HemisphericLight("HemiLight",new BABYLON.Vector3(0,-1,0),this.scene),this.light.intensity=1,this.light.groundColor=new BABYLON.Color3(1,1,1),this.light.specular=BABYLON.Color3.Black(),this.createPlayer(),this.tiles=new A(this),this.tiles.generate(),this.ageTimer=new N(this),this.stageCounter=new C(this),setTimeout((function(){e.scams=new y(e),e.scams.generate()}),GAME.options.player.scamStartAfter),setTimeout((function(){e.boons=new L(e),e.boons.generate()}),3*GAME.options.player.scamStartAfter+500),this.speedTrigger=setInterval((function(){e.setGameSpeed()}),15e3),this.scene.useMaterialMeshMap=!0,this.scene.debugLayer.hide()}},{key:"createMenus",value:function(){var e=this;this.menu=new l("runnerMenuUI"),this.lostScreen=this.menu.addImage("lostScreen",{imgpath:"assets/scenes/Game_over_screen.png",width:.95,height:.9}),this.winningScreen=this.menu.addImage("winningScreen",{imgpath:"assets/scenes/winning_screen_1.png",width:.95,height:.9}),this.gameSubTextControl=this.menu.addText("You cannot give up. Try reaching Age 65...",{width:.85,top:20*GAME.engine.getRenderHeight()/100,fontSize:"15px",fontStyle:"bold",verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP}),this.pointsTextControl=this.menu.addText("Pension Pot: £ 0",{top:30*GAME.engine.getRenderHeight()/100,color:GAME.options.pointsTextColor,fontStyle:"bold",fontSize:"28px",verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP}),this.currentRecordTextControl=this.menu.addText("Highest Record: 0",{top:40*GAME.engine.getRenderHeight()/100,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP}),this.hasMadeRecordTextControl=this.menu.addText("You got a new Points Record!",{top:46*GAME.engine.getRenderHeight()/100,color:GAME.options.recordTextColor,fontSize:"20px",verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP}),this.lastText=this.menu.addText("lastText",{top:72*GAME.engine.getRenderHeight()/100,fontSize:"15px",color:GAME.options.recordTextColor,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,width:.85}),this.menu.addImgButton("replayButton",{width:.5,imgpath:"assets/scenes/Play_again.png",top:50*GAME.engine.getRenderHeight()/100,height:"50px",verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,onclick:function(){e.player.selectSound.play(),GAME.goToLevel("TutorialLevel")}}),this.menu.addImgButton("Share",{width:.5,imgpath:"assets/scenes/share.png",top:50*GAME.engine.getRenderHeight()/100+50,height:"50px",verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,onclick:function(){e.player.selectSound.play();var t="\nMy high score on Scam Man and Robbin' is "+e.player.getLastRecord()+"! Think you can beat it? \nCheck out the game for yourself and see if you can spot the most common pension scams before they destroy your retirement savings. Good luck! \n",n="Hey!%0D%0A%0D%0AMy high score on Scam Man and Robbin' is "+e.player.getLastRecord()+"! Think you can beat it?%0D%0A%0D%0ACheck out the game for yourself and see if you can spot the most common pension scams before they destroy your retirement savings. Good luck!%0D%0A"+window.location.href+"%0D%0A%0D%0ALearn more about how to protect yourself from pension scams: [http://www.scam-man.com]";jsSocials.shares.email.shareUrl="mailto:{to}?subject=Here's my Scam Man and Robbin' score...&body="+n,jsSocials.shares.facebook.shareUrl="https://www.facebook.com/sharer/sharer.php?u="+window.location.href+"&quote="+t;var i=["twitter","facebook","email"];(GAME.isMobile()||GAME.isPad())&&i.push("whatsapp"),$("#share").jsSocials({shares:i,url:window.location.href,text:t,showLabel:!1,shareIn:"popup"}),document.getElementById("myModal").style.display="block",setTimeout((function(){document.getElementById("myModal").classList.add("popup-open")}),100)}}),this.menu.addImgButton("Learn more",{imgpath:"assets/scenes/learnmore.png",top:88*GAME.engine.getRenderHeight()/100,height:"15px",width:.2,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,onclick:function(){e.player.selectSound.play(),window.open(GAME.options.learnMoreLink,"_blank")}}),this.menu.hide()}},{key:"createCamera",value:function(){var e=new BABYLON.UniversalCamera("camera",new BABYLON.Vector3(0,0,-8),this.scene);return e.setTarget(BABYLON.Vector3.Zero()),e}},{key:"createPlayer",value:function(){var e=this;this.player=new h(this),this.playerLight=new BABYLON.DirectionalLight("playerLight",new BABYLON.Vector3(0,-1,1),this.scene),this.playerLight.intensity=20,this.playerLight.includedOnlyMeshes.push(this.player.mesh),this.playerLight.parent=this.player.mesh,this.light.excludedMeshes.push(this.player.mesh),this.player.onDie=function(){e.player.gameEnded=!0,e.player.shootAction&&(e.player.shootAction.dispose(),clearInterval(e.player.shootTrigger)),e.player.bullet&&(e.player.bullet.isVisible=!1),e.player.potImg.source="assets/scenes/pot.png",clearInterval(e.speedTrigger),e.player.mesh.material.alpha=0;var t=new BABYLON.Sprite("player",e.player.spriteManagerPlayer.lose);t.position=new BABYLON.Vector3(e.player.mesh.position.x,e.player.mesh.position.y-.1,0),t.height=.9,t.width=.7,t.isPickable=!0,e.player.gameLostSound.play(),t.playAnimation(0,2,!1,400,(function(){GAME.pause(),e.showMenu(),e.ageTimer.clear(),e.player.hud.hide(),e.player.pauseButtonControl.isVisible=!1,e.player.soundMuteButtonControl.isVisible=!1,e.player.soundUnMuteButtonControl.isVisible=!1}))},this.player.win=function(){e.player.gameEnded=!0,clearInterval(e.speedTrigger),e.player.winningSound.play(),e.player.mesh.material.alpha=0,e.playerWin(),setTimeout((function(){e.player.hud.hide(),GAME.pause(),e.status="WIN",e.showMenu(),e.ageTimer.clear(),e.player.pauseButtonControl.isVisible=!1,e.player.soundMuteButtonControl.isVisible=!1,e.player.soundUnMuteButtonControl.isVisible=!1}),1500)}}},{key:"showMenu",value:function(){this.menu.show(),this.lastText.text="Unfortunately, Scam Man won't be on hand to protect you! So it is important to know how to identify a pension scam.",this.pointsTextControl.text="Pension Pot: £"+this.player.getPoints(),this.currentRecordTextControl.text="Highest Record: "+this.player.getLastRecord(),"WIN"==this.status?(this.lostScreen.isVisible=!1,this.gameSubTextControl.text="Congratulations! You successfully avoided the scams and completed level 3!"):(this.pointsTextControl.text="Pension Pot: £ 0",this.winningScreen.isVisible=!1,this.gameSubTextControl.text="You lost! Play again and see if you can avoid the scams to reach level 3!"),this.player.hasMadePointsRecord()?this.hasMadeRecordTextControl.isVisible=!0:this.hasMadeRecordTextControl.isVisible=!1}},{key:"beforeRender",value:function(){GAME.isPaused()||(this.player.pauseButtonControl.isVisible=!0,this.player.coinsTextControl.isVisible=!0,this.player.move(),this.age=parseInt(this.ageTimer.ageControl.text),(this.age-18)%16!=0||this.currentStageAge===this.age||this.player.gameEnded||(this.freezeGeneration=!0,this.holdStage=!0,this.completeStage()),this.player.beamEnabled||!this.player.changePosition||this.player.playerLanding||this.player.gameEnded?this.player.mesh.material.alpha=0:this.player.mesh.material.alpha=1),this.player.maxCoins&&this.player.coins<=1&&!this.player.gameEnded&&(this.player.allowCoinChange=!1,this.player.onDie&&(this.ageTimer.clear(),this.player.onDie()))}},{key:"replay",value:function(){this.player.reset(),this.speed=GAME.options.player.defaultSpeed,this.menu.hide(),this.status=null,this.ageTimer.advancedTexture.isVisible=!1,this.ageTimer.clear(),this.ageTimer=new N(this),this.nextStage=1,this.currentStageAge=0,this.player.gameEnded=!1,GAME.resume()}},{key:"getGameSpeed",value:function(){return this.speed}},{key:"setGameSpeed",value:function(){GAME.isPaused()||(this.speed+=GAME.options.player.increaseSpeedRatio)}},{key:"completeStage",value:function(){var e=this;this.indication=!1,1===this.nextStage&&GAME.engine.hideLoadingUI();var t=setInterval((function(){e.holdStage&&(e.freezeGeneration&&e.scams&&!e.scams.activeScams.length&&e.boons&&!e.boons.activeBoons.length&&e.tiles&&!e.tiles.activeCoins.length||1===e.nextStage)&&(e.player.infoSound.play(),1==e.nextStage?(e.stageCounter.showStage(e.nextStage),e.nextStage++):(e.player.playerLanding=!0,e.playerWin(),setTimeout((function(){e.stageCounter.showStage(e.nextStage),e.nextStage++,e.wPlayer.dispose()}),3e3)),e.currentStageAge=e.age,e.holdStage=!1,clearInterval(t))}),1e3)}},{key:"playerWin",value:function(){this.wPlayer=new BABYLON.Sprite("player",this.player.spriteManagerPlayer.win),this.wPlayer.position=this.player.mesh.position,this.wPlayer.position=new BABYLON.Vector3(this.player.mesh.position.x+.2,this.player.mesh.position.y,0),this.wPlayer.size=1.2,this.wPlayer.isPickable=!0}}])&&O(n.prototype,i),o&&O(n,o),t}(g);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Y(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var P=function(e){function t(){return x(this,t),Y(this,R(t).apply(this,arguments))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(t,e),n=t,(i=[{key:"setupAssets",value:function(){this.assets.addSound("selectSound","assets/sounds/Select_sound.wav")}},{key:"buildScene",value:function(){new BABYLON.FreeCamera("camera1",new BABYLON.Vector3(0,5,-10),this.scene),this.scene.clearColor=new BABYLON.Color4(0,0,0,0);var e=new l("homeMenuUI"),t=this.assets.getSound("selectSound");e.addImage("LOGO",{imgpath:"assets/scenes/scamman_logo.png",width:.7,height:.38,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,top:Math.floor(3*GAME.engine.getRenderHeight()/100)}),e.addImgButton("playButton",{imgpath:"assets/scenes/Start_v2.png",height:"60px",width:.55,top:Math.floor(48*GAME.engine.getRenderHeight()/100),verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,onclick:function(){BABYLON.Engine.audioEngine.unlock(),t.play(),GAME.goToLevel("TutorialLevel")}})}}])&&k(n.prototype,i),o&&k(n,o),t}(g);function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function F(e,t){return!t||"object"!==V(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Z(e,t){return(Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var j=function(e){function t(){return z(this,t),F(this,D(t).apply(this,arguments))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z(e,t)}(t,e),n=t,(i=[{key:"setProperties",value:function(){this.player=null,this.tiles=null,this.menu=null,this.pointsTextControl=null,this.currentRecordTextControl=null,this.hasMadeRecordTextControl=null,this.status=null,this.speed=GAME.options.player.defaultSpeed+10,this.freezeGeneration=!1,this.age=18,this.gameStarted=!1,this.currentTimeLength=0}},{key:"setupAssets",value:function(){this.assets.addMusic("music","assets/musics/SCAM_MAN_background2.wav",{volume:.0025,autoplay:!0}),this.assets.addSound("gameLostSound","assets/sounds/game-lost.wav",{volume:.01}),this.assets.addSound("gotCoinSound","assets/sounds/coin_going_into_pot.wav",{volume:8e-4}),this.assets.addSound("beginGameSound","assets/sounds/begin_game.wav",{volume:.0015}),this.assets.addSound("infoSound","assets/sounds/info.wav",{volume:.001}),this.assets.addSound("damageSound","assets/sounds/scammed.wav",{volume:.001}),this.assets.addSound("movementSound","assets/sounds/movement.wav",{volume:.002}),this.assets.addSound("zappingSound","assets/sounds/Zapping_Scam.wav",{volume:3e-4}),this.assets.addSound("winningSound","assets/sounds/Winning_Sound.wav",{volume:.001}),this.assets.addSound("splashScreenSound","assets/sounds/Winning_Sound.wav",{volume:.001}),this.assets.addSound("selectSound","assets/sounds/Select_sound.wav",{volume:.001})}},{key:"buildScene",value:function(){var e=this;this.scene.clearColor=new BABYLON.Color3.FromHexString(GAME.options.backgroundColor);var t=this.createCamera();this.scene.activeCamera=t,this.light=new BABYLON.HemisphericLight("HemiLight",new BABYLON.Vector3(0,-1,0),this.scene),this.light.intensity=1,this.light.groundColor=new BABYLON.Color3(1,1,1),this.light.specular=BABYLON.Color3.Black(),this.createPlayer(),this.tiles=new A(this),this.tiles.generate(),this.scams=new y(this),this.boons=new L(this),this.scene.useMaterialMeshMap=!0,this.scene.debugLayer.hide(),this.scene.onPointerObservable.add((function(t){BABYLON.Engine.audioEngine.unlock(),e.audioUnlocked=!0}))}},{key:"createTutorialText",value:function(e){var t=this;if(this.player){GAME.pause(),this.activeMessage=!0,this.player.infoSound.play();var n="",i=.15;1==e?(n="Welcome to Scam Man and Robbin’! \n\n You are Scam Man, a cloaked vigilante who’s on a mission to protect people’s pensions from scams. \n\n I’m Robbin’, and I’m here to help you!",i=.35):2==e?(n="You must correctly identify six of the most common pension scams and destroy them. \n\n Collect the bonuses and coins to build a healthy pension pot and be in with a chance of winning. ",i=.31):3==e?n=GAME.isMobile()||GAME.isPad()?"Swipe left and right on the screen to move in each direction…":"Use left and right arrow keys to move in each direction…":4==e?n="Collect as many coins as you can by letting them fall on you…":5==e?n=GAME.isMobile()||GAME.isPad()?"Swipe upwards to activate your torch and shine a light on the falling scams to destroy them…":"Use spacebar or up arrow key to activate your torch and shine a light on the falling scams to destroy them…":6==e&&(n="Be sure to collect any bonuses that fall, but don’t shine your torch on them as this will destroy them…");var o=new l("stageLoadingUI",!0),s=o.menuTexture,a=new BABYLON.GUI.Rectangle;a.width=1,a.height=1,a.thickness=0,a.background="grey",a.alpha=.75,s.addControl(a);var r=new BABYLON.GUI.Image("icon","assets/scenes/tutorial_plate.png");r.width=1,r.height=i,r.top=16*GAME.engine.getRenderHeight()/100,r.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,r.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,s.addControl(r);var c=new BABYLON.GUI.Image("icon","assets/scenes/tutorial_plate_robin_v2.png");c.width=.22,c.height=.051,c.top=11*GAME.engine.getRenderHeight()/100,c.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,c.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,s.addControl(c);var h=new BABYLON.GUI.Rectangle;h.width=.67,h.height=i,h.left="-15px",h.top=15*GAME.engine.getRenderHeight()/100,h.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_RIGHT,h.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,h.thickness=0,s.addControl(h);var u=new BABYLON.GUI.Image("icon","assets/scenes/Robin thumb.png");u.width=.23,u.height=.11,u.left="15px",u.top=GAME.engine.getRenderHeight()*(.15==i?17.5:23.5)/100,u.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT,u.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,s.addControl(u);var d=new BABYLON.GUI.TextBlock;d.text=n,d.fontSize=GAME.engine.getRenderHeight()<600?11:13,d.textHorizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,d.textVerticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER,d.textWrapping=!0,d.fontFamily="'Tomorrow',sans-serif",h.addControl(d);var p=setInterval((function(){t.skipControl.thickness=t.skipControl.thickness?0:1.5}),300);if(this.skipControl=o.addImgButton("continueBtn",{imgpath:"assets/scenes/Continue.png",top:GAME.engine.getRenderHeight()*(100*(i+.16))/100,width:.2,height:.055,thickness:1.5,color:"white",horizontalAlignment:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,verticalAlignment:BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,onclick:function(){t.player.pausedImage.isVisible||(r.dispose(),c.dispose(),h.dispose(),u.dispose(),d.dispose(),clearInterval(p),t.skipControl.dispose(),a.dispose(),t.activeMessage=!1,GAME.resume(),e<4&&t.createTutorialText(e+1))}}),1==e){var g=new BABYLON.GUI.Rectangle;g.width=1,g.height=.1,g.horizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,g.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP,g.thickness=0,g.background="#45186e",s.addControl(g);var m=new BABYLON.GUI.TextBlock;m.text="Tutorial Mode",m.color="white",m.fontSize=15,m.textHorizontalAlignment=BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER,m.textVerticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER,m.textWrapping=!0,m.fontFamily="'Tomorrow',sans-serif",g.addControl(m)}}}},{key:"createCamera",value:function(){var e=new BABYLON.UniversalCamera("camera",new BABYLON.Vector3(0,0,-8),this.scene);return e.setTarget(BABYLON.Vector3.Zero()),e}},{key:"createPlayer",value:function(){var e=this;this.player=new h(this),this.player.playerLanding=!0,this.playerLight=new BABYLON.DirectionalLight("playerLight",new BABYLON.Vector3(0,-1,1),this.scene),this.playerLight.intensity=20,this.playerLight.includedOnlyMeshes.push(this.player.mesh),this.playerLight.parent=this.player.mesh,this.light.excludedMeshes.push(this.player.mesh),this.player.onDie=function(){e.player.gameEnded=!0,clearInterval(e.speedTrigger),e.player.mesh.material.alpha=0;var t=new BABYLON.Sprite("player",e.player.spriteManagerPlayer.lose);t.position=e.player.mesh.position,t.position=new BABYLON.Vector3(e.player.mesh.position.x,e.player.mesh.position.y-.2,0),t.size=.8,t.isPickable=!0,e.player.gameLostSound.play(),t.playAnimation(0,2,!1,400,(function(){GAME.pause(),e.player.pauseButtonControl.isVisible=!1,e.player.soundMuteButtonControl.isVisible=!1,e.player.soundUnMuteButtonControl.isVisible=!1}))},this.player.win=function(){e.player.gameEnded=!0,clearInterval(e.speedTrigger),e.player.winningSound.play(),GAME.pause(),e.status="WIN",e.player.pauseButtonControl.isVisible=!1,e.player.soundMuteButtonControl.isVisible=!1,e.player.soundUnMuteButtonControl.isVisible=!1},this.tutorialTrigger=setInterval((function(){e.currentTimeLength>=GAME.options.tutorialLength&&(e.freezeGeneration=!0,setTimeout((function(){e.player.gameEnded||(e.player.gameEnded=!0,clearInterval(e.scams.trigger),clearInterval(e.boons.trigger),GAME.goToLevel("RunnerLevel"))}),3e3),clearInterval(e.tutorialTrigger)),7===e.currentTimeLength&&e.scams.generate(),18===e.currentTimeLength&&(e.player.freezeScams=!0,e.boons.generate()),GAME.isPaused()||(e.currentTimeLength+=1)}),1e3)}},{key:"beforeRender",value:function(){var e=this;GAME.isPaused()||(this.player.pauseButtonControl.isVisible=!0,this.player.coinsTextControl.isVisible=!1,this.player.move(),this.player.beamEnabled||!this.player.changePosition||this.player.playerLanding||this.player.gameEnded||!this.nextStage?this.player.mesh.material.alpha=0:this.player.mesh.material.alpha=1,this.gameStarted||(setTimeout((function(){e.nextStage=1,e.player.landPlayer(),e.createTutorialText(1),e.player.skipControl.isVisible=!0}),2e3),this.freezeGeneration=!0,this.gameStarted=!0,this.player.mesh.material.alpha=0))}},{key:"getGameSpeed",value:function(){return this.speed}}])&&H(n.prototype,i),o&&H(n,o),t}(g);function W(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var q=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(W(this,e),this.options=t,this.keys={},this.paused=!1,this.log=new s,this.isMobile()||this.isPad()){this.canvas=document.getElementById("renderCanvas");var n=document.getElementsByClassName("device")[0];n&&(n.style.display="none")}else{this.canvas=document.getElementById("renderCanvasDesktop"),$(".device-frame").width($("#canvas").height()/1.7786);var i=document.getElementById("renderCanvas");i&&(i.style.display="none")}this.engine=new BABYLON.Engine(this.canvas,!1),this.audioEngine=new BABYLON.AudioEngine,this.audioEngine.useCustomUnlockedButton=!0,this.currentLevel=null,this.currentLevelName="HomeMenuLevel",this.levels={HomeMenuLevel:new P,RunnerLevel:new S,TutorialLevel:new j}}var t,n,i;return t=e,(n=[{key:"start",value:function(){this.listenKeys(),this.lintenTouchEvents(),this.listenOtherEvents(),this.startLevel()}},{key:"pause",value:function(e){!this.paused&&e&&this.currentLevel.player&&(GAME.pause(),this.currentLevel.player.pausedImage.isVisible=!0,this.currentLevel.player.resumeButton.isVisible=!0,this.currentLevel.player.skipControl&&(this.currentLevel.player.skipControl.isVisible=!1)),this.paused=!0}},{key:"isPaused",value:function(){return this.paused}},{key:"resume",value:function(){this.paused=!1}},{key:"listenKeys",value:function(){document.addEventListener("keydown",function(e){87==e.keyCode||38==e.keyCode?this.keys.shoot=1:65==e.keyCode||37==e.keyCode?this.keys.left=1:68==e.keyCode||39==e.keyCode?this.keys.right=1:80!=e.keyCode&&32!=e.keyCode||(this.keys.shoot=1)}.bind(this)),document.addEventListener("keyup",function(e){87==e.keyCode||38==e.keyCode?this.keys.shoot=0:65==e.keyCode||37==e.keyCode?this.keys.left=0:68==e.keyCode||39==e.keyCode?this.keys.right=0:80!=e.keyCode&&32!=e.keyCode||(this.keys.shoot=0)}.bind(this)),this.keys.up=!1,this.keys.down=!1,this.keys.left=!1,this.keys.right=!1,this.keys.shoot=!1}},{key:"lintenTouchEvents",value:function(){var e=this,t=new Hammer(document.body);t.get("swipe").set({direction:Hammer.DIRECTION_ALL}),t.on("swipeup",(function(t){t.preventDefault(),e.keys.shoot=1,setTimeout((function(){e.keys.shoot=0}),150)})),t.on("swipedown",(function(t){e.keys.down=1,setTimeout((function(){e.keys.down=0}),100)})),t.on("swipeleft",(function(t){e.keys.left=2,setTimeout((function(){e.keys.left=0}),80)})),t.on("swiperight",(function(t){e.keys.right=2,setTimeout((function(){e.keys.right=0}),80)}))}},{key:"listenOtherEvents",value:function(){var e=this;window.addEventListener("blur",(function(){e.pause(!0)})),window.addEventListener("focus",(function(){}))}},{key:"goToLevel",value:function(e){this.levels[e]?(this.currentLevel&&this.currentLevel.exit(),this.currentLevelName=e,this.startLevel()):console.error("A level with name "+e+" does not exists")}},{key:"startLevel",value:function(){this.currentLevel=this.levels[this.currentLevelName],this.currentLevel.start()}},{key:"render",value:function(){var e=this;this.startRenderLoop(),window.addEventListener("resize",(function(){e.engine.resize()}))}},{key:"startRenderLoop",value:function(){var e=this;this.engine.runRenderLoop((function(){window.addEventListener("resize",(function(){e.engine.resize(),e.isMobile()||e.isPad()||window.location.reload()})),e.currentLevel.scene.render()}))}},{key:"stopRenderLoop",value:function(){this.engine.stopRenderLoop()}},{key:"isMobile",value:function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}},{key:"isPad",value:function(){var e=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|android|playbook|silk|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))return!0;try{if(null!==e.match(/Macintosh/i)){var t=document.createElement("canvas");if(null!==t){var n=t.getContext("webgl")||t.getContext("experimental-webgl");if(n){var i=n.getExtension("WEBGL_debug_renderer_info");if(i&&-1!==n.getParameter(i.UNMASKED_RENDERER_WEBGL).indexOf("Apple"))return!0}}}}catch(e){console.log(e)}return!1}}])&&K(t.prototype,n),i&&K(t,i),e}();window.GAME=null;var J=function(){GAME=new q(window.initialGameOptions),GAME.start()};window.addEventListener("load",(function(){J()}))}});